

# π Solar Monitor Pro - κ°€μƒ μ‹λ®¬λ μ΄ν„° (Virtual Simulator)

μ΄ ν”„λ΅μ νΈλ” Solar Monitor Proμ λ°±μ—”λ“ λ° ν”„λ΅ νΈμ—”λ“ κ°λ°μ„ μ„ν•΄ μ‹¤μ  ν•λ“μ›¨μ–΄ μ—†μ΄λ„ μ‚¬μ‹¤μ μΈ νƒμ–‘κ΄‘ λ°μ „ λ°μ΄ν„°λ¥Ό μƒμ„±ν•κ³  API μ„λ²„λ΅ μ „μ†΅ν•λ” Python κΈ°λ°μ κ°€μƒ μ‹λ®¬λ μ΄ν„°μ…λ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

  - **μ‹¤μ‹κ°„ λ°μ΄ν„° μƒμ„±**: 1μ΄ λ‹¨μ„λ΅ νƒμ–‘κ΄‘ λ°μ „ κ΄€λ ¨ λ°μ΄ν„°λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
  - **λ™μ  μ μ–΄**: μ‹¤ν–‰ μ¤‘ `config.json` νμΌ μμ •λ§μΌλ΅ μ‹λ®¬λ μ΄μ… ν™κ²½(ν¨λ„ μ, λ‚ μ”¨ λ“±)μ„ μ‹¤μ‹κ°„ λ³€κ²½ν•  μ μμµλ‹λ‹¤.
  - **ν„μ‹¤μ μΈ ν™κ²½ λ°μ**:
      - **μ‹κ°„ λ° κ³„μ **: νƒμ–‘ μ„μΉ κ³„μ‚° λΌμ΄λΈλ¬λ¦¬(`suncalc`)λ¥Ό μ‚¬μ©ν•μ—¬ μΌμ¶/μΌλ° λ° κ³„μ μ— λ”°λ¥Έ λ°μ „λ‰ λ³€ν™”λ¥Ό μλ™μΌλ΅ μ‹λ®¬λ μ΄μ…ν•©λ‹λ‹¤.
      - **μ‹¤μ‹κ°„ λ‚ μ”¨**: OpenWeatherMap APIμ™€ μ—°λ™ν•μ—¬ μ‹¤μ  λ‚ μ”¨(λ§‘μ, κµ¬λ¦„, λΉ„ λ“±)λ¥Ό λ°μ „λ‰ κ³„μ‚°μ— λ°μν•©λ‹λ‹¤.
  - **μƒμ„Έ λ΅κΉ…**: λ°μ΄ν„° μƒμ„±, μ „μ†΅ μ„±κ³µ/μ‹¤ν¨ λ“± λ¨λ“  κ³Όμ •μ„ μ¶”μ ν•  μ μλ” μƒμ„Έν• λ΅κ·Έλ¥Ό μ κ³µν•©λ‹λ‹¤.
  - **ν…μ¤νΈ μ„λ²„ ν¬ν•¨**: μ „μ†΅λ λ°μ΄ν„°κ°€ μ¬λ°”λ¥Έ ν•μ‹μΌλ΅ μμ‹ λλ”μ§€ μ¦‰μ‹ ν™•μΈν•  μ μλ” κ°„λ‹¨ν• Flask ν…μ¤νΈ μ„λ²„(`test_server.py`)κ°€ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.

## β™οΈ μ‹μ¤ν… μ”κµ¬μ‚¬ν•­

  - Windows 10/11 λλ” macOS
  - Python 3.8 μ΄μƒ
  - Homebrew (macOS μ‚¬μ©μ)

## π€ μ„¤μΉ λ° μ„¤μ • κ°€μ΄λ“

### 1λ‹¨κ³„: Python μ„¤μΉ

  - **Windows:**

    1.  [python.org](https://python.org/)μ—μ„ μµμ‹  λ²„μ „μ Pythonμ„ λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤.
    2.  μ„¤μΉ ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ μ‹, **λ°λ“μ‹ "Add Python.exe to PATH" μµμ…μ„ μ²΄ν¬**ν•©λ‹λ‹¤.
    3.  μ„¤μΉ ν›„ ν„°λ―Έλ„(PowerShell)μ—μ„ `python --version` λ…λ Ήμ–΄λ΅ μ„¤μΉλ¥Ό ν™•μΈν•©λ‹λ‹¤.

  - **macOS:**

    1.  ν„°λ―Έλ„μ„ μ—΄κ³ , [Homebrew](https://www.google.com/search?q=https://brew.sh/index_ko)κ°€ μ„¤μΉλμ–΄ μμ§€ μ•λ‹¤λ©΄ μ•„λ λ…λ Ήμ–΄λ΅ μ„¤μΉν•©λ‹λ‹¤.
        ```bash
        /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
        ```
    2.  Homebrewλ¥Ό ν†µν•΄ Python μµμ‹  λ²„μ „μ„ μ„¤μΉν•©λ‹λ‹¤.
        ```bash
        brew install python
        ```
    3.  μ„¤μΉ ν›„ ν„°λ―Έλ„μ—μ„ `python3 --version` λ…λ Ήμ–΄λ΅ μ„¤μΉλ¥Ό ν™•μΈν•©λ‹λ‹¤.

### 2λ‹¨κ³„: `uv` μ„¤μΉ

`uv`λ” λ§¤μ° λΉ λ¥Έ νμ΄μ¬ ν¨ν‚¤μ§€ κ΄€λ¦¬ λ„κµ¬μ…λ‹λ‹¤.

  - **Windows:**
    PowerShellμ„ **κ΄€λ¦¬μ κ¶ν•μΌλ΅ μ‹¤ν–‰**ν•κ³  μ•„λ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.

    ```powershell
    powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
    ```

  - **macOS:**
    ν„°λ―Έλ„μ— μ•„λ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.

    ```bash
    curl -LsSf https://astral.sh/uv/install.sh | sh
    ```

μ„¤μΉ ν›„ μƒ ν„°λ―Έλ„μ—μ„ `uv --version` λ…λ Ήμ–΄λ΅ μ„¤μΉλ¥Ό ν™•μΈν•©λ‹λ‹¤.

### 3λ‹¨κ³„: ν”„λ΅μ νΈ νμΌ μ¤€λΉ„

1.  `solar-simulator`μ™€ κ°™μ€ ν”„λ΅μ νΈ ν΄λ”λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
2.  μ΄μ „ μ•λ‚΄μ—μ„ μ κ³µλ `config.json`, `simulator.py`, `test_server.py` νμΌμ„ μ΄ ν΄λ” μ•μ— μ €μ¥ν•©λ‹λ‹¤.

### 4λ‹¨κ³„: κ°€μƒ ν™κ²½ λ° λΌμ΄λΈλ¬λ¦¬ μ„¤μΉ

ν”„λ΅μ νΈ ν΄λ”μ—μ„ ν„°λ―Έλ„μ„ μ—΄κ³  μ•„λ λ…λ Ήμ–΄λ¥Ό μμ„λ€λ΅ μ‹¤ν–‰ν•©λ‹λ‹¤.

1.  **κ°€μƒ ν™κ²½ μƒμ„± (Windows & macOS λ™μΌ)**

    ```bash
    uv venv
    ```

2.  **κ°€μƒ ν™κ²½ ν™μ„±ν™”**

      - **Windows (PowerShell):**
        ```bash
        .\.venv\Scripts\activate
        ```
      - **macOS (zsh/bash):**
        ```bash
        source .venv/bin/activate
        ```

    ν„°λ―Έλ„ ν”„λ΅¬ν”„νΈ μ•μ— `(.venv)`κ°€ ν‘μ‹λλ©΄ κ°€μƒ ν™κ²½μ΄ ν™μ„±ν™”λ κ²ƒμ…λ‹λ‹¤.

3.  **ν•„μ”ν• λΌμ΄λΈλ¬λ¦¬ μ„¤μΉ (Windows & macOS λ™μΌ)**

    ```bash
    uv pip install requests suncalc pytz Flask
    ```

### 5λ‹¨κ³„: API ν‚¤ μ„¤μ •

1.  [OpenWeatherMap](https://openweathermap.org/)μ— κ°€μ…ν•κ³  λ¬΄λ£ API ν‚¤λ¥Ό λ°κΈ‰λ°›μµλ‹λ‹¤.
2.  `config.json` νμΌμ„ μ—΄μ–΄ `YOUR_OPENWEATHERMAP_API_KEY` λ¶€λ¶„μ„ μμ‹ μ API ν‚¤λ΅ κµμ²΄ν•©λ‹λ‹¤.

## β–¶οΈ μ‚¬μ© λ°©λ²•

λ‘ κ°μ ν„°λ―Έλ„ μ°½μ„ μ‚¬μ©ν•©λ‹λ‹¤. κ° ν„°λ―Έλ„μ—μ„ **λ°λ“μ‹ λ¨Όμ € κ°€μƒ ν™κ²½μ„ ν™μ„±ν™”**ν•΄μ•Ό ν•©λ‹λ‹¤.

**ν„°λ―Έλ„ 1: ν…μ¤νΈ μ„λ²„ μ‹¤ν–‰**

> μ΄ ν„°λ―Έλ„μ—λ” μ‹λ®¬λ μ΄ν„°λ΅λ¶€ν„° μμ‹ λ λ°μ΄ν„°κ°€ JSON ν•μ‹μΌλ΅ μ¶λ ¥λ©λ‹λ‹¤.

  - **Windows:**
    ```bash
    .\.venv\Scripts\activate
    python test_server.py
    ```
  - **macOS:**
    ```bash
    source .venv/bin/activate
    python3 test_server.py
    ```

**ν„°λ―Έλ„ 2: μ‹λ®¬λ μ΄ν„° μ‹¤ν–‰**

> μ΄ ν„°λ―Έλ„μ—λ” λ°μ΄ν„° μƒμ„± λ° μ „μ†΅ μƒνƒμ— λ€ν• λ΅κ·Έκ°€ μ¶λ ¥λ©λ‹λ‹¤.

  - **Windows:**
    ```bash
    .\.venv\Scripts\activate
    python simulator.py
    ```
  - **macOS:**
    ```bash
    source .venv/bin/activate
    python3 simulator.py
    ```

## λ°μ΄ν„° ν¬λ©§
```json
{
  "μ¥μΉID": "νƒμ–‘κ΄‘_ν¨λ„_01",
  "λ°μ΄ν„°_μμ‹ _μ‹κ°": "2025-10-08T16:10:14.840374+09:00",
  "μ „λ ¥_κ³„μΈ΅": {
    "μ „μ••_V": 221.44,
    "μ „λ¥_A": 2.34,
    "μ ν¨_μ „λ ¥_W": 509.73,
    "ν”Όμƒ_μ „λ ¥_VA": 517.5,
    "μ—­λ¥ ": 0.985
  },
  "λ„μ _μ—λ„μ§€_kWh": 4.2233,
  "λ°°ν„°λ¦¬_μ •λ³΄": {
    "μ‚¬μ©_μ—¬λ¶€": true,
    "μƒνƒ": "λ°©μ „ μ¤‘",
    "μ¶©μ „_μƒνƒ_%": 44.54,
    "μ „λ ¥_νλ¦„_W": -468.43,
    "λ°°ν„°λ¦¬_μ©λ‰_kWh": 10,
    "λ°°ν„°λ¦¬_μ¨λ„_β„ƒ": 27.53
  },
  "ν™κ²½_μ •λ³΄": {
    "μ΅°λ„_Lux": 55992.84,
    "ν¨λ„_μ¨λ„_β„ƒ": 39.99,
    "μ™Έλ¶€_μ¨λ„_β„ƒ": 26.9,
    "μµλ„_%": 51.4
  }
}

```

```json
{
  "deviceId": "SOLAR_PANEL_01",
  "timestamp": "2025-10-08T16:13:03.326859+09:00",
  "power_metrics": {
    "voltage_v": 221.4,
    "current_a": 2.3,
    "active_power_w": 497.64,
    "apparent_power_va": 508.84,
    "power_factor": 0.978
  },
  "energy_kwh": 4.2427,
  "battery_metrics": {
    "enabled": true,
    "status": "Discharging",
    "soc_percent": 44.35,
    "power_flow_w": -475.43,
    "capacity_kwh": 10,
    "temperature_c": 27.63
  },
  "environment": {
    "illuminance_lux": 54715.35,
    "panel_temp_c": 38.22,
    "ambient_temp_c": 26.72,
    "humidity_percent": 50.21
  }
}
```

## π”§ λ¬Έμ  ν•΄κ²°

  - **`ModuleNotFoundError` λ°μƒ μ‹**: ν„°λ―Έλ„μ— `(.venv)` ν‘μ‹κ°€ μλ”μ§€ ν™•μΈν•μ„Έμ”. μ—†λ‹¤λ©΄ κ° μ΄μμ²΄μ μ— λ§λ” κ°€μƒ ν™κ²½ ν™μ„±ν™” λ…λ Ήμ–΄λ¥Ό λ¨Όμ € μ‹¤ν–‰ν•μ„Έμ”.
  - **λ°μ΄ν„°κ°€ μμ‹ λμ§€ μ•μ„ κ²½μ°**:
    1.  `simulator.py`μ `requests.post` λ¶€λ¶„μ΄ μ£Όμ„ μ²λ¦¬λμ–΄ μμ§€ μ•μ€μ§€ ν™•μΈν•μ„Έμ”.
    2.  `test_server.py` μ‹¤ν–‰ μ‹ μ΄μμ²΄μ (Windows λλ” macOS)μ **λ°©ν™”λ²½ ν—μ©** μ°½μ΄ λ¨λ©΄ λ°λ“μ‹ \*\*'ν—μ©'\*\*μ„ ν΄λ¦­ν–λ”μ§€ ν™•μΈν•μ„Έμ”.